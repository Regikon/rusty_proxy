# Rusty Proxy

Небольшое приложение-прокси, написанное (с болью) на Rust.

## Как запустить?

Для запуска в настоящий момент обязательно нужно иметь
SSL сертификаты (нет возможности выбрать тип проксирования).

Для домена mail.ru уже сгенерирован сертификат и он располагается
в директории ./certs. Там же находится скрипт для генерации
сертификата, подписанного корневым сертификатом.

Для указания другого домена нужно отредактировать файл ca.ext и
перечислить сам домен и его синонимы в строке subjectAltName.

Для запуска в докере необходимо собрать образ и запустить его,
смаппив порт 8080 на удобный.

```bash

docker build -t rusty_proxy .
docker run -p 127.0.0.1:8080:8080 rusty_proxy

```

## Для проверки

### curl

Для проверки через curl можно воспользоваться командами

```bash

curl --insecure -x http://127.0.0.1:8080 https://mail.ru/
curl -x http://127.0.0.1:8080 http://mail.ru

```

Важно. Не нужно подключаться к прокси как к https серверу,
вам не ответят.

### Браузер

Для проверки браузером нужно добавить в его настройки прокси
IP прокси и добавить корневой сертификат rootCA.crt в доверенные.

Если всё ок, то будет загружена страница https://mail.ru
(или другая, подписанная сертификатом). Возможно сгенерированный
сертификат не охватывает все домены mail.ru, но с почтой результат
удовлетворительный.

## О зависимостях

Здесь перечислены зависимости кода и объяснения, что они такое

* hyper - низкоуровневая реализация http протокола
* tokio - асинхронный runtime для rust
* hyper-util - небольшие хелперы для hyper
* http-body-util - хелпер-структуры для тел http сообщений
* http - структуры представляющие сущности http
* log - пакет макросов для логирования
* simplelog - реализация логирования
* bytes - пакет для некопирующей работы с байтами
* thiserror - пакет макросов для типов-ошибок
* rustls - реализация TLS для rust
* tokio-rustls - обертка rustls для асинхронной работы
* webpki-roots - корневые сертификаты mozilla (для работы клиентской стороны прокси)
